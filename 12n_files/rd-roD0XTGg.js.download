;/*FB_PKG_DELIM*/

__d("LSDeleteRtcOngoingCallData",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(23).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteRtcOngoingCallDataStoredProcedure";a.__tables__=["rtc_ongoing_calls_on_threads_v2"];e.exports=a}),null);
__d("LSUpdateOrInsertRtcOngoingCallData",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.filter(b.db.table(23).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))}).next().then(function(d,e){var f=d.done;d=d.value;return f?(b.i64.eq(a[3],void 0)||!1?0:0,b.db.table(23).add({threadKey:a[0],ongoingCallServerInfoData:a[1],willExpandToNewThread:a[2],ongoingCallTimestampMs:a[3]})):(e=d.item,c[1]=e.ongoingCallTimestampMs,b.i64.eq(c[1],void 0)||!1?0:0,b.forEach(b.filter(b.db.table(23).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))}),function(b){var d=b.update;b.item;return d({ongoingCallServerInfoData:a[1]==null?e.ongoingCallServerInfoData:a[1],willExpandToNewThread:a[2],ongoingCallTimestampMs:a[3]==null?c[1]:a[3]})}))})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxUpdateOrInsertRtcOngoingCallDataStoredProcedure";a.__tables__=["rtc_ongoing_calls_on_threads_v2"];e.exports=a}),null);
__d("LSUpdateThreadOngoingCallState",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.i64.neq(a[1],b.i64.cast([0,0]))?0:0,(b.i64.eq(a[2],void 0)||!1)&&b.i64.neq(a[1],b.i64.cast([0,0]))?0:0,b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({ongoingCallState:a[1],ongoingCallTimestampMs:a[2]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateThreadOngoingCallStateStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);